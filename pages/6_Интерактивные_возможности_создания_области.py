import streamlit as st
from PIL import Image
import base64
import subprocess
import os
import math
import gmsh
import numpy as np
import matplotlib.pyplot as plt
import multiprocessing
import plotly.graph_objects as go  # –î–ª—è 3D-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

st.set_page_config(page_title="üì±", layout="wide")

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–¥–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
def show_code(code, language="python"):
    st.code(code, language)

def run_gmsh(file_path):
    try:
        env = os.environ.copy()
        env["LIBGL_ALWAYS_SOFTWARE"] = "1"  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
        subprocess.run(["gmsh", file_path], check=True, env=env)
        st.success("Gmsh —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω –≤ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–º —Ä–µ–∂–∏–º–µ!")
    except FileNotFoundError:
        st.error("Gmsh –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ PATH.")
    except subprocess.CalledProcessError as e:
        st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Gmsh: {e.returncode}")
        st.text(f"–í—ã–≤–æ–¥ –æ—à–∏–±–∫–∏:\n{e.stderr}")

sections = {
    "–®–∞–≥ 1. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏": "",
    "–®–∞–≥ 2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ—á–µ–∫": "",
    "–®–∞–≥ 3. –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–æ—á–µ–∫": "",
    "–®–∞–≥ 4. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏":"",
    "–®–∞–≥ 5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ç–∫–∏": "",
    "–®–∞–≥ 6. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è": "",
    "–®–∞–≥ 7. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞": "",
    "–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ Gmsh": "", 
    "–ó–∞–∫–ª—é—á–µ–Ω–∏–µ": "",

}

choice = st.sidebar.radio("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª", list(sections.keys()))

if choice == "–®–∞–≥ 1. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏":

    st.markdown("""
    <style>
    pre, code {
        background-color: #e6e6e6 !important; /* –°–≤–µ—Ç–ª–æ-—Å–µ—Ä—ã–π —Ñ–æ–Ω */
        color: #008000 !important; /* –ó–µ–ª—ë–Ω—ã–π —Ç–µ–∫—Å—Ç */
        font-weight: normal !important; /* –û–±—ã—á–Ω—ã–π —à—Ä–∏—Ñ—Ç */
        padding: 8px;
        border-radius: 5px;
    }
    </style>
    """, unsafe_allow_html=True)


    # –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏
    st.write("""##### –®–∞–≥ 1. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏""")
    st.write("""
    1. –û—Ç–∫—Ä–æ–π—Ç–µ Gmsh: 
    ``` bash 
            gmsh
    ```
    2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –º–µ–Ω—é "File" –∏ –≤—ã–±–µ—Ä–∏—Ç–µ "New" –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞.
    """)
    # –ú–µ—Å—Ç–æ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ (—à–∞–≥ 1)
    st.image("step1_create_geometry.png", caption="–®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏",use_container_width=True)

    def run_gmsh_view():
        try:
            # –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å GMSH
            subprocess.run(["gmsh"], check=True)
        except subprocess.CalledProcessError as e:
            st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Gmsh: {e}")
        except FileNotFoundError:
            st.error("Gmsh –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GMSH —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ø—É—Ç–∏.")

    if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å Gmsh"):
        run_gmsh_view()

elif choice == "–®–∞–≥ 2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ—á–µ–∫":

    # –®–∞–≥ 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ—á–µ–∫
    st.write("""##### –®–∞–≥ 2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ—á–µ–∫""")
    st.write("""
    –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ –Ω–∞—á–Ω–µ–º —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è 4 —Ç–æ—á–µ–∫.
    –í –≤–µ—Ä—Ö–Ω–µ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ "Geometry" -> "Elementary entitie" -> "Add" -> "Point"  –∏ —â–µ–ª–∫–Ω–∏—Ç–µ –Ω–∞ —Ä–∞–±–æ—á–µ–π –æ–±–ª–∞—Å—Ç–∏, —á—Ç–æ–±—ã —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Ç–æ—á–∫–∏.
    - —Ç–æ—á–∫–∞ 1: [0,0,0];
    - —Ç–æ—á–∫–∞ 2: [L, 0, 0] ‚Äî –≥–¥–µ L ‚Äî –¥–ª–∏–Ω–∞ –æ–±–ª–∞—Å—Ç–∏;
    - —Ç–æ—á–∫–∞ 3: [L, W, 0] ‚Äî –≥–¥–µ W ‚Äî —à–∏—Ä–∏–Ω–∞ –æ–±–ª–∞—Å—Ç–∏;
    - —Ç–æ—á–∫–∞ 4: [0, W, 0];
    """)
    # –ú–µ—Å—Ç–æ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ (—à–∞–≥ 2)
    st.image("step2_define_points.png", caption="–®–∞–≥ 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ—á–µ–∫", use_container_width=True)

    def run_gmsh_view():
        try:
            # –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å GMSH
            subprocess.run(["gmsh"], check=True)
        except subprocess.CalledProcessError as e:
            st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Gmsh: {e}")
        except FileNotFoundError:
            st.error("Gmsh –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GMSH —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ø—É—Ç–∏.")

    if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å Gmsh"):
        run_gmsh_view()

elif choice == "–®–∞–≥ 3. –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–æ—á–µ–∫":

    # –®–∞–≥ 3: –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–æ—á–µ–∫
    st.write("""##### –®–∞–≥ 3. –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–æ—á–µ–∫""")
    st.write("""
    –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —Ç–æ—á–∫–∏ —Ä–∞–∑–º–µ—â–µ–Ω—ã, –∏—Ö –Ω—É–∂–Ω–æ —Å–æ–µ–¥–∏–Ω–∏—Ç—å.
    1. –í –≤–µ—Ä—Ö–Ω–µ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ "Geometry" -> "Elementary entitie" -> "Add" -> "Line".
    2. –°–æ–µ–¥–∏–Ω–∏—Ç–µ —Ç–æ—á–∫–∏ —Å –ø–æ–º–æ—â—å—é –ª–∏–Ω–∏–π:
    - –ª–∏–Ω–∏—è 1: —Å–æ–µ–¥–∏–Ω—è–µ—Ç —Ç–æ—á–∫—É 1 –∏ —Ç–æ—á–∫—É 2;
    - –ª–∏–Ω–∏—è 2: —Å–æ–µ–¥–∏–Ω—è–µ—Ç —Ç–æ—á–∫—É 2 –∏ —Ç–æ—á–∫—É 3;
    - –ª–∏–Ω–∏—è 3: —Å–æ–µ–¥–∏–Ω—è–µ—Ç —Ç–æ—á–∫—É 3 –∏ —Ç–æ—á–∫—É 4;
    - –ª–∏–Ω–∏—è 4: —Å–æ–µ–¥–∏–Ω—è–µ—Ç —Ç–æ—á–∫—É 4 –∏ —Ç–æ—á–∫—É 1;
    """)
    # –ú–µ—Å—Ç–æ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ (—à–∞–≥ 3)
    st.image("step3_connect_points.png", caption="–®–∞–≥ 3: –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–æ—á–µ–∫", use_container_width=True)

    def run_gmsh_view():
        try:
            # –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å GMSH
            subprocess.run(["gmsh"], check=True)
        except subprocess.CalledProcessError as e:
            st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Gmsh: {e}")
        except FileNotFoundError:
            st.error("Gmsh –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GMSH —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ø—É—Ç–∏.")

    if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å Gmsh"):
        run_gmsh_view()

elif choice == "–®–∞–≥ 4. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏":

    # –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
    st.write("""##### –®–∞–≥ 4. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏""")
    st.write("""
    –¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å –≤—Å–µ –ª–∏–Ω–∏–∏, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å, –∑–∞–∫–ª—é—á–µ–Ω–Ω—É—é –≤ —ç—Ç–∏—Ö –ª–∏–Ω–∏—è—Ö.
    1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –º–µ–Ω—é "Geometry" -> "Elementary entitie" -> "Add" -> "Plane surface".
    2. –í—ã–±–µ—Ä–∏—Ç–µ –ª–∏–Ω–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏.
    """)
    # –ú–µ—Å—Ç–æ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ (—à–∞–≥ 4)
    st.image("step4_create_surface.png", caption="–®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏", use_container_width=True)

    def run_gmsh_view():
        try:
            # –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å GMSH
            subprocess.run(["gmsh"], check=True)
        except subprocess.CalledProcessError as e:
            st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Gmsh: {e}")
        except FileNotFoundError:
            st.error("Gmsh –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GMSH —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ø—É—Ç–∏.")

    if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å Gmsh"):
        run_gmsh_view()

elif choice == "–®–∞–≥ 5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ç–∫–∏":

    # –®–∞–≥ 5: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ç–∫–∏
    st.write("""##### –®–∞–≥ 5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ç–∫–∏""")
    st.write("""
    –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≥–µ–æ–º–µ—Ç—Ä–∏–∏ –º–æ–∂–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç–∫—É.
    1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –º–µ–Ω—é "Mesh" –∏ –≤—ã–±–µ—Ä–∏—Ç–µ "2D" –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–≤—É–º–µ—Ä–Ω–æ–π —Å–µ—Ç–∫–∏ –¥–ª—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏.
    2. Gmsh –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–µ—Ç–∫—É –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞.
    """)
    # –ú–µ—Å—Ç–æ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ (—à–∞–≥ 5)
    st.image("step5_generate_mesh.png", caption="–®–∞–≥ 5: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ç–∫–∏", use_container_width=True)

    def run_gmsh_view():
        try:
            # –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å GMSH
            subprocess.run(["gmsh"], check=True)
        except subprocess.CalledProcessError as e:
            st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Gmsh: {e}")
        except FileNotFoundError:
            st.error("Gmsh –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GMSH —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ø—É—Ç–∏.")

    if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å Gmsh"):
        run_gmsh_view()

elif choice == "–®–∞–≥ 6. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è":

    # –®–∞–≥ 6: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
    st.write("""##### –®–∞–≥ 6. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è""")
    st.write("""
    –ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ—Ç–∫–∏ –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É "View" –∏ –≤–∫–ª—é—á–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–µ—Ç–∫–∏.
    –í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ü–≤–µ—Ç–∞–º–∏, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∏ –¥—Ä—É–≥–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.
    """)
    # –ú–µ—Å—Ç–æ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ (—à–∞–≥ 6)
    st.image("step6_visualize.png", caption="–®–∞–≥ 6: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∫–∏", use_container_width=True)

    def run_gmsh_view():
        try:
            # –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å GMSH
            subprocess.run(["gmsh"], check=True)
        except subprocess.CalledProcessError as e:
            st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Gmsh: {e}")
        except FileNotFoundError:
            st.error("Gmsh –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GMSH —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ø—É—Ç–∏.")

    if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å Gmsh"):
        run_gmsh_view()

elif choice == "–®–∞–≥ 7. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞":

    # –®–∞–≥ 7: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
    st.write("""##### –®–∞–≥ 7: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞""")
    st.write("""
    –í—ã –º–æ–∂–µ—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª, –≤—ã–±—Ä–∞–≤ "File" -> "Save Mesh".
    """)
    # –ú–µ—Å—Ç–æ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ (—à–∞–≥ 7)
    st.image("step7_save_file.png", caption="–®–∞–≥ 7: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞", use_container_width=True)

    def run_gmsh_view():
        try:
            # –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å GMSH
            subprocess.run(["gmsh"], check=True)
        except subprocess.CalledProcessError as e:
            st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Gmsh: {e}")
        except FileNotFoundError:
            st.error("Gmsh –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GMSH —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ø—É—Ç–∏.")

    if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å Gmsh"):
        run_gmsh_view()

elif choice == "–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ Gmsh":

    # –ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã GMSH
    st.write("""##### –ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ Gmsh""")
    st.write("""
    –í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Gmsh –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–µ–æ–º–µ—Ç—Ä–∏–∏ –∏ —Å–µ—Ç–∫–∏ —á–µ—Ä–µ–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª. –í–æ—Ç –ø—Ä–∏–º–µ—Ä —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏:

    ```bash
    // –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏ LxW

    L = 10;  // –¥–ª–∏–Ω–∞
    W = 5;   // —à–∏—Ä–∏–Ω–∞

    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ—á–µ–∫
    Point(1) = {0, 0, 0, 1};
    Point(2) = {L, 0, 0, 1};
    Point(3) = {L, W, 0, 1};
    Point(4) = {0, W, 0, 1};

    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–∏–Ω–∏–π
    Line(1) = {1, 2};
    Line(2) = {2, 3};
    Line(3) = {3, 4};
    Line(4) = {4, 1};

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
    Line Loop(1) = {1, 2, 3, 4};
    Plane Surface(1) = {1};

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ç–∫–∏
    Mesh 2;
    """)

    def run_gmsh_view():
        try:
            # –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å GMSH
            subprocess.run(["gmsh"], check=True)
        except subprocess.CalledProcessError as e:
            st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Gmsh: {e}")
        except FileNotFoundError:
            st.error("Gmsh –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GMSH —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ø—É—Ç–∏.")

    if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å Gmsh"):
        run_gmsh_view()

elif choice == "–ó–∞–º–µ—á–∞–Ω–∏–µ":
    st.write("""##### –ó–∞–º–µ—á–∞–Ω–∏–µ""")
    st.write(""" Gmsh –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≥–µ–æ–º–µ—Ç—Ä–∏–π —Å –ø–æ–º–æ—â—å—é –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞. –ú—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Gmsh –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø—Ä–æ—Å—Ç—ã—Ö –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –æ–±–ª–∞—Å—Ç–µ–π, –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ—Ç–æ–∫ –∏ –∏—Ö –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∫–∏ –≤–æ–∑–º–æ–∂–Ω–∞ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. """)